from base64 import b64decode as dec
exec(dec('ZnJvbSBvcyBpbXBvcnQgc3lzdGVtLCBsaXN0ZGlyLCBnZXRjd2QsIHJlbW92ZQpmcm9tIG9zLnBhdGggaW1wb3J0IGpvaW4gYXMgcGpvaW4sIGFic3BhdGgKZnJvbSB0aW1lIGltcG9ydCBzbGVlcApmcm9tIHJhbmRvbSBpbXBvcnQgcmFuZGludCBhcyBybnQKZnJvbSB6aXBmaWxlIGltcG9ydCBaaXBGaWxlCnN5c3RlbSgncGlwIGluc3RhbGwgc2VsZW5pdW09PTMuMTQxIHNlbGVuaXVtLXV0aWxpdGllcyByZXF1ZXN0cyB1Z2VudHMgcHl0ZXNzZXJhY3QnKQpmcm9tIHNlbGVuaXVtIGltcG9ydCB3ZWJkcml2ZXIKZnJvbSBzZWxlbml1bS53ZWJkcml2ZXIuY29tbW9uLmFjdGlvbl9jaGFpbnMgaW1wb3J0IEFjdGlvbkNoYWlucwpmcm9tIHNlbGVuaXVtLndlYmRyaXZlci5zdXBwb3J0LnVpIGltcG9ydCBXZWJEcml2ZXJXYWl0CmZyb20gc2VsZW5pdW0ud2ViZHJpdmVyLmNvbW1vbi5ieSBpbXBvcnQgQnkKZnJvbSBzZWxlbml1bS53ZWJkcml2ZXIuc3VwcG9ydCBpbXBvcnQgZXhwZWN0ZWRfY29uZGl0aW9ucyBhcyBFQwpmcm9tIHNlbGVuaXVtX3V0aWxpdGllcyBpbXBvcnQgZ2V0Q2hyb21lRHJpdmVyCmZyb20gdWdlbnRzIGltcG9ydCBnZXRBZ2VudCBhcyBnYQpmcm9tIHJlcXVlc3RzIGltcG9ydCBnZXQsIHBvc3QKZnJvbSBiYXNlNjQgaW1wb3J0IGI2NGRlY29kZSBhcyBkZWMKZnJvbSBweXRlc3NlcmFjdCBpbXBvcnQgcHl0ZXNzZXJhY3QKZnJvbSBweXRlc3NlcmFjdCBpbXBvcnQgaW1hZ2VfdG9fc3RyaW5nCgp3aXRoIG9wZW4oJ3Rlc3MuemlwJywgJ3diJykgYXMgZjoKCWYud3JpdGUoZ2V0KCdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vcmVwb25hbWUvdGVzcy9tYWluL3Rlc3MuemlwJykuY29udGVudCkKd2l0aCBaaXBGaWxlKCd0ZXNzLnppcCcsICdyJykgYXMgejoKICAgIHouZXh0cmFjdGFsbChnZXRjd2QoKSkKcmVtb3ZlKCd0ZXNzLnppcCcpCgpkZWYgZ2V0QWdlbnQoKToKCWFnZW50ID0gJycKCWNoYW5jZSA9IHJudCgxLCAxMDApCglpZiBjaGFuY2UgPj0gMjA6CgkJYnJvd3NlciA9ICdDaHJvbWUnCgllbGlmIGNoYW5jZSA8PSA1OgoJCWJyb3dzZXIgPSAnT3BlcmEnCgllbHNlOgoJCWJyb3dzZXIgPSAnRmlyZWZveCcKCXdoaWxlICdXaW5kb3dzJyBhbmQgYnJvd3NlciBub3QgaW4gYWdlbnQ6CgkJYWdlbnQgPSBnYSgpCglyZXR1cm4gYWdlbnQKCmRlZiBjaGVja0J1dHRvbihkcml2ZXIpOgoJdHJ5OgoJCWlmICdQcmVtaXVtJyBpbiBkcml2ZXIuZmluZF9lbGVtZW50X2J5X3hwYXRoKCcvaHRtbC9ib2R5L2RpdlsyXS9kaXZbMl0vZGl2WzJdL2Rpdi9kaXYvZGl2L2Rpdi9kaXZbNV0vZGl2WzNdL2EnKS50ZXh0OgoJCQlyZXR1cm4gVHJ1ZQoJZXhjZXB0OgoJCXBhc3MKCXJldHVybiBGYWxzZQoKZGVmIGNsaWNrQW5kQW5hbHl6ZShpdGVtKToKCXNyYyA9IGRyaXZlci5wYWdlX3NvdXJjZQoJQWN0aW9uQ2hhaW5zKGRyaXZlcikubW92ZV90b19lbGVtZW50KGl0ZW0pLmNsaWNrKCkucGVyZm9ybSgpCglpZiBsZW4oZHJpdmVyLndpbmRvd19oYW5kbGVzKSA+IDE6CgkJZHJpdmVyLnN3aXRjaF90b193aW5kb3coZHJpdmVyLndpbmRvd19oYW5kbGVzWzFdKQoJCWRyaXZlci5jbG9zZSgpCgkJZHJpdmVyLnN3aXRjaF90b193aW5kb3coZHJpdmVyLndpbmRvd19oYW5kbGVzWzBdKQoJCWlmIHNyYyA9PSBkcml2ZXIucGFnZV9zb3VyY2U6CgkJCWNsaWNrQW5kQW5hbHl6ZShpdGVtKQoKZGVmIGluaXQoKToKCW9wdGlvbnMgPSB3ZWJkcml2ZXIuQ2hyb21lT3B0aW9ucygpCglvcHRpb25zLmFkZF9hcmd1bWVudCgndXNlci1hZ2VudD17fScuZm9ybWF0KGdldEFnZW50KCkpKQoJb3B0aW9ucy5hZGRfZXhwZXJpbWVudGFsX29wdGlvbigiZXhjbHVkZVN3aXRjaGVzIiwgWyJlbmFibGUtYXV0b21hdGlvbiJdKQoJb3B0aW9ucy5hZGRfZXhwZXJpbWVudGFsX29wdGlvbigndXNlQXV0b21hdGlvbkV4dGVuc2lvbicsIEZhbHNlKQoKCWRyaXZlciA9IHdlYmRyaXZlci5DaHJvbWUoZXhlY3V0YWJsZV9wYXRoPWdldENocm9tZURyaXZlcigpLCBjaHJvbWVfb3B0aW9ucz1vcHRpb25zKQoJaWYgbGVuKGRyaXZlci53aW5kb3dfaGFuZGxlcykgPiAxOgoJCWRyaXZlci5zd2l0Y2hfdG9fd2luZG93KGRyaXZlci53aW5kb3dfaGFuZGxlc1swXSkKCQlkcml2ZXIuY2xvc2UoKQoJCWRyaXZlci5zd2l0Y2hfdG9fd2luZG93KGRyaXZlci53aW5kb3dfaGFuZGxlc1swXSkKCXJldHVybiBkcml2ZXIKCmRlZiBzb2x2ZUNhcHRjaGEoKToKCXB5dGVzc2VyYWN0LnRlc3NlcmFjdF9jbWQgPSBwam9pbihnZXRjd2QoKSwgJ1Rlc3NlcmFjdC1PQ1InLCAndGVzc2VyYWN0JykKCXRleHQgPSBpbWFnZV90b19zdHJpbmcoJ2NhcHRjaGEucG5nJywgY29uZmlnPSctLXBzbSA2JykKCXRyeToKCQlyZXR1cm4gdGV4dC5zcGxpdCgnRW50ZXI6XG4nKVsxXS5zdHJpcCgpCglleGNlcHQ6CgkJcmV0dXJuIHRleHQuc3BsaXQoJ0VudGVyOiAnKVsxXS5zdHJpcCgpCgpsaW5rID0gJ2h0dHBzOi8vcmFwaWRnYXRvci5uZXQvZmlsZS9mZDc4MDE2YmRiZWJmNDU3ZWEyNjNjMTZmY2JhYTRjMScKCm9sZCA9IFRydWUKd2hpbGUgb2xkOgoJZHJpdmVyID0gaW5pdCgpCglpZiBsZW4oZHJpdmVyLndpbmRvd19oYW5kbGVzKSA+IDE6CgkJZHJpdmVyLnN3aXRjaF90b193aW5kb3coZHJpdmVyLndpbmRvd19oYW5kbGVzWzBdKQoJCWRyaXZlci5jbG9zZSgpCgkJZHJpdmVyLnN3aXRjaF90b193aW5kb3coZHJpdmVyLndpbmRvd19oYW5kbGVzWzBdKQoJZHJpdmVyLmdldCgnaHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS9yZWNhcHRjaGEvYXBpMi9kZW1vJykKCXRyeToKCQlXZWJEcml2ZXJXYWl0KGRyaXZlciwgMTApLnVudGlsKEVDLmZyYW1lX3RvX2JlX2F2YWlsYWJsZV9hbmRfc3dpdGNoX3RvX2l0KChCeS5DU1NfU0VMRUNUT1IsImlmcmFtZVtuYW1lXj0nYS0nXVtzcmNePSdodHRwczovL3d3dy5nb29nbGUuY29tL3JlY2FwdGNoYS9hcGkyL2FuY2hvcj8nXSIpKSkKCQlvbGQgPSBGYWxzZQoJZXhjZXB0OgoJCWRyaXZlci5xdWl0KCkKCWlmIG5vdCBvbGQ6CgkJZHJpdmVyLmdldCgnaHR0cHM6Ly93d3cueW91dHViZS5jb20vb29wcycpCgkJZHJpdmVyLmV4ZWN1dGVfc2NyaXB0KGYnZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImxvZ28tY29udGFpbmVyIikuaHJlZiA9ICJ7bGlua30iJykKCQlzbGVlcCgxKQoKCQlkcml2ZXIuZmluZF9lbGVtZW50X2J5X2lkKCdsb2dvLWNvbnRhaW5lcicpLmNsaWNrKCkKCQl3aGlsZSAneW91dHViZScgaW4gZHJpdmVyLmN1cnJlbnRfdXJsOgoJCQlzbGVlcCgxKQoKCQl0cnk6CgkJCWNsaWNrQW5kQW5hbHl6ZShkcml2ZXIuZmluZF9lbGVtZW50X2J5X3hwYXRoKCcvaHRtbC9ib2R5L2RpdlsxXS9kaXZbM10vZGl2L2RpdlszXS9kaXZbM10vZGl2WzZdL2Rpdi9kaXYvdGFibGUvdGJvZHkvdHJbMV0vdGhbMl0vYScpKQoKCQkJd2hpbGUgVHJ1ZToKCQkJCXRyeToKCQkJCQl3aXRoIG9wZW4oJ2NhcHRjaGEucG5nJywgJ3diJykgYXMgZjoKCQkJCQkJZi53cml0ZShkZWMoZHJpdmVyLmV4ZWN1dGVfc2NyaXB0KCcnJ3JldHVybiBnZXRDb21wdXRlZFN0eWxlKHRvcC53aW5kb3cuZnJhbWVzWzBdLmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvdmVybGF5JykpLmJhY2tncm91bmRJbWFnZS5zbGljZSg0LCAtMSkucmVwbGFjZSgvIi9nLCAnJykucmVwbGFjZSgnZGF0YTppbWFnZS9wbmc7YmFzZTY0LCcsICcnKTsnJycpKSkKCQkJCQlicmVhawoJCQkJZXhjZXB0OgoJCQkJCXBhc3MKCgkJCWRyaXZlci5maW5kX2VsZW1lbnRfYnlfaWQoJ2FkY29weV9yZXNwb25zZScpLnNlbmRfa2V5cyhzb2x2ZUNhcHRjaGEoKSkKCQkJY2xpY2tBbmRBbmFseXplKGRyaXZlci5maW5kX2VsZW1lbnRfYnlfeHBhdGgoJy9odG1sL2JvZHkvZGl2WzFdL2RpdlszXS9kaXYvZGl2L2RpdlsyXS9kaXYvZGl2WzFdL2Zvcm0vZGl2WzJdL2Evc3BhbicpKQoJCQlzbGVlcCg1KQoJCQljbGlja0FuZEFuYWx5emUoZHJpdmVyLmZpbmRfZWxlbWVudF9ieV94cGF0aCgnL2h0bWwvYm9keS9kaXZbMV0vZGl2WzNdL2Rpdi9kaXYvZGl2WzJdL2RpdlsyXS9kaXYvZGl2L2Evc3BhbicpKQoJCWV4Y2VwdDoKCQkJZHJpdmVyLnF1aXQoKQoJCQlvbGQgPSBUcnVlCgpzbGVlcCgyMCkKcG9zdChmJ2h0dHBzOi8vYXBpLmdpdGh1Yi5jb20vcmVwb3MvbWF5M2JlbGF0ZXIveW91dHViZS9hY3Rpb25zL3dvcmtmbG93cy8yMzI5NDEwOS9kaXNwYXRjaGVzJywgaGVhZGVycz17J0F1dGhvcml6YXRpb24nOiBmJ3Rva2VuIGdocF9MNjVvbnJjajZBUkFUSUJEdnk0dklhOUplQjJKZXIzbEdMcnAnfSwganNvbj17J3JlZic6ICdtYWluJ30pCmV4aXQoKQ==').decode('utf-8'))